#!/usr/bin/env bash
#
# Looks for markdown files in the hints folder, and opens it in vim
#
# USAGE:
#    $ hint vim
#    # => will open my vim hints in vim
#
#    $ hint -l
#    # => will list available hints
type vi >/dev/null 2>&1 || { echo >&2 "I require vi but it's not installed."; exit 1; }

TOOL=${1:?Usage: hint <toolname> [-l]}
ADD_OPTION=${2:-no}

USER_DIR=$HOME/.dotfiles/hints
USER_FILE=$USER_DIR/${TOOL}.md

if [ ! -d $USER_DIR ]; then
  mkdir -p $USER_DIR
fi

if [ "$TOOL" == "-l" ]; then
  echo
  ls -1 $USER_DIR | grep ".md" | sed -e 's/\.md$//'
  exit 0
fi

if [ -s $USER_FILE ] || [ "$ADD_OPTION" == "-a" ]; then
  vi $USER_FILE 2>/dev/null
else
  read -r -p "${3:-No hints for ${TOOL} were found. Would you like to create a new hint? [y/N]} " response
    case $response in
      [yY][eE][sS]|[yY])
        vi $USER_FILE 2>/dev/null
        ;;
      *)
        echo "ok"
        ;;
    esac
fi

